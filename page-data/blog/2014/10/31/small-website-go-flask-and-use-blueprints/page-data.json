{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2014/10/31/small-website-go-flask-and-use-blueprints/","result":{"data":{"site":{"siteMetadata":{"title":"Marcus Sanatan"}},"markdownRemark":{"id":"7bbcdce8-2f7d-554e-a99e-5ee7ca8d1a07","excerpt":"It seems I’ve got into web development more and more. As I’m sticking to a language I know and love, I’m using Flask - a super awesome microframework  based on…","html":"<p>It seems I’ve got into web development more and more. As I’m sticking to a language I know and love, I’m using <a href=\"http://flask.pocoo.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Flask</a> - a super awesome microframework  based on the powerful Werkzeug and Jinja2 libraries. Why not Django? No particular reason, I’ve used it before and just prefer how easy it is to get up and running with Flask!</p>\n<p>For those too lazy to follow the links (shame on you!) here’s a basic Hello World in Flask to make you excited:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> Flask\napp <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span>\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">hello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello World!\"</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    app<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Blueprints For Large Projects, Blueprints For Small Projects</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/49430b061a31fb0f815c74fec6d6438e/6b690/organise_flask_todo.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfklEQVR42mOYk2g9L95iXrz5/Diz+bHGQDQnyhAPmhVl2B9uMiHcZHaUIYOKdaCipZ+UsaeInquonquYgbuSVYCipT8EwdnK1oGqNkFK1sG6dv6FgXY5/vaatgEMuvaB3VPnLV+3ddr85bOXrO6dPt/UPdzCK8rCE4SMXcPMPSOBXAPHYB1bfy27QDMHn6YIu+pQO0N7PwY9x+Djp8/9+fXj69cv////f/jk2eadB96///D4yfMXL1+t3rTz3oNH375+y6lolTN203MIAuqXtQqWtwrWsgsAag7ad/jEq1evHz959uPHz2u37m7fc+jrly8vX71++/bdhm17nz57/v/f34LaDjkjV6BmbbsAPXsQAjIYdOwDnEOSvaOzXEJTnYKT7QMSbHxjXUJAbCCy8olxCkoCShm7hWva+AM1ICMGINYCesbWX8PaV8XcS83SR93KV9XCG4LUrXyApIqFt6aNH5pOqGYosg/QwUBAcTgDr2bSEYpmLVs/gghZMwDSENFWnbeISwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Organise - Flask Todo App\"\n        title=\"\"\n        src=\"/static/49430b061a31fb0f815c74fec6d6438e/0a47e/organise_flask_todo.png\"\n        srcset=\"/static/49430b061a31fb0f815c74fec6d6438e/8a4e8/organise_flask_todo.png 150w,\n/static/49430b061a31fb0f815c74fec6d6438e/5a46d/organise_flask_todo.png 300w,\n/static/49430b061a31fb0f815c74fec6d6438e/0a47e/organise_flask_todo.png 600w,\n/static/49430b061a31fb0f815c74fec6d6438e/1cfc2/organise_flask_todo.png 900w,\n/static/49430b061a31fb0f815c74fec6d6438e/c1b63/organise_flask_todo.png 1200w,\n/static/49430b061a31fb0f815c74fec6d6438e/6b690/organise_flask_todo.png 2556w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>In this post I’ll show you how you can apply blueprints to small projects, like the todo example you go through in the Flask tutorial. Blueprints allow for a more modular Flask app, they can encapsulate related tasks and be reused in an application by changing URL prefixes. The Flask docs do a great job of explaining it!</p>\n<p>Instead of dealing with raw SQL, I prefer to use Flask-SQLAlchemy so I can utilise an ORM. The model for a todo is as simple as you expect it:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Todo</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token builtin\">id</span> <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span>Column<span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Integer<span class=\"token punctuation\">,</span> primary_key<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    title <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span>Column<span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>String<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> unique<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> nullable<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n    description <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span>Column<span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>String<span class=\"token punctuation\">(</span><span class=\"token number\">300</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> nullable<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> description<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> title\n        self<span class=\"token punctuation\">.</span>description <span class=\"token operator\">=</span> description\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__repr__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">'Todo: %r'</span> <span class=\"token operator\">%</span> self<span class=\"token punctuation\">.</span>title</code></pre></div>\n<p>And the change from defining views for a Flask app to views for a blueprint isn’t that alarming. Here’s the initialisation and the 3 basic views for a todo:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">todos <span class=\"token operator\">=</span> Blueprint<span class=\"token punctuation\">(</span><span class=\"token string\">'todos'</span><span class=\"token punctuation\">,</span> __name__<span class=\"token punctuation\">,</span> template_folder<span class=\"token operator\">=</span><span class=\"token string\">'/../templates'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token decorator annotation punctuation\">@todos<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    all_todos <span class=\"token operator\">=</span> Todo<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span>order_by<span class=\"token punctuation\">(</span>Todo<span class=\"token punctuation\">.</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">.</span>desc<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'todos.html'</span><span class=\"token punctuation\">,</span> all_todos<span class=\"token operator\">=</span>all_todos<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token decorator annotation punctuation\">@todos<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/add'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">add_todo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    todo <span class=\"token operator\">=</span> Todo<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'description'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>todo<span class=\"token punctuation\">)</span>\n    db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>commit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    flash<span class=\"token punctuation\">(</span><span class=\"token string\">'New todo was added'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'todos.index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token decorator annotation punctuation\">@todos<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/todo//delete'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">delete_todo</span><span class=\"token punctuation\">(</span>t_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    todo <span class=\"token operator\">=</span> Todo<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span>filter_by<span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token operator\">=</span>t_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>first_or_404<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>delete<span class=\"token punctuation\">(</span>todo<span class=\"token punctuation\">)</span>\n    db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>commit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    flash<span class=\"token punctuation\">(</span><span class=\"token string\">'Todo successfully deleted'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'todos.index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>I also created a blueprint to handle static pages, like the home and about page. If you structure your Flask app <a href=\"http://flask.pocoo.org/docs/0.10/patterns/packages/#larger-applications\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">like a package</a>, then in your <strong>init.py</strong> of your views module you can define your 404 view function as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>errorhandler</span><span class=\"token punctuation\">(</span><span class=\"token number\">404</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">page_not_found</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'404.html'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">404</span></code></pre></div>\n<p>All in all, you got a well organised flask app!</p>\n<h2>Random Notes</h2>\n<p>I’m no web designer, and that site is somehow visually tolerable. Checkout <a href=\"https://bootswatch.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Bootswatch</a> for some free themes that replaces Bootstrap’s standard ones. Technically this was supposed to be a weekend hack… but a great El Clásico occurred and life drove me in other directions, until about Sunday evening when I finally started coding this up!</p>\n<p>Lastly, you can get the complete source code right here: <a href=\"https://github.com/msanatan/organise\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><a href=\"https://github.com/msanatan/organise\">https://github.com/msanatan/organise</a></a></p>","frontmatter":{"title":"Small Website? Go Flask, and Use Blueprints","tags":["python","flask"],"date":"2014-10-31","updated":null}},"previous":{"fields":{"slug":"/blog/2014/10/25/more-about-my-nerd-side"},"frontmatter":{"title":"More About My Nerd Side"}},"next":{"fields":{"slug":"/blog/2014/11/09/easy-emails-with-sendgrid"},"frontmatter":{"title":"Easy Emails with SendGrid"}}},"pageContext":{"id":"7bbcdce8-2f7d-554e-a99e-5ee7ca8d1a07","previousPostId":"bff752c6-5f33-5fba-8d87-edcbb3a96721","nextPostId":"63e9721e-c302-5b96-bbec-32c2502362c3"}},"staticQueryHashes":["1391858338"],"slicesMap":{}}