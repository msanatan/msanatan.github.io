{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2017/10/05/fun-with-pygame/","result":{"data":{"site":{"siteMetadata":{"title":"Marcus Sanatan"}},"markdownRemark":{"id":"41d7556c-8e0a-56ce-80fc-20f4faeba704","excerpt":"Hey everyone! A lot of you don’t know but I’m involved with an educational NGO called Click To Start. Click To Start provides free digital literacy classes for…","html":"<p>Hey everyone! A lot of you don’t know but I’m involved with an educational NGO called <a href=\"https://www.clicktostart.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Click To Start</a>. Click To Start provides free digital literacy classes for senior citizens, and in 2017 it provided its first programming class aimed at teenagers! Programming is as rewarding as it is challenging so we tried to incentivise the students by teaching them how to make games - which we all love to do. Python was chosen as the language of instruction as it’s one of the more English-like options out there. We then settled on Pygame to teach them game development, as it’s pretty straightforward to get into once you know Python. The plus side of helping out was that I had to create games myself! I mean, we need to give them exercises that’ll push and entertain them, right? One of the games they worked on was Tic Tac Toe. Creating it in Pygame was fun, so I thought I’d share how to do it.</p>\n<h2>Simple Design</h2>\n<p>This Tic Tac Toe iteration will be pretty simple:</p>\n<ul>\n<li>X plays before O</li>\n<li>Each cell is numbered from 1 to 9</li>\n<li>The user presses the number and plays in that position</li>\n<li>Only 2 player, no AI</li>\n<li>After the game is done and winner announced (if any), a user can restart</li>\n</ul>\n<h2>Setup</h2>\n<p>As it’s a one screen game the setup for this is pretty basic. We’ll keep all the code in one file.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Basic imports</span>\n<span class=\"token keyword\">import</span> pygame\n<span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">import</span> os\n\nos<span class=\"token punctuation\">.</span>environ<span class=\"token punctuation\">[</span><span class=\"token string\">'SDL_VIDEO_CENTERED'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'1'</span>\nSCREEN_SIZE <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">800</span><span class=\"token punctuation\">,</span> <span class=\"token number\">640</span><span class=\"token punctuation\">)</span>\nBLACK <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nWHITE <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span>\nGREEN <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\nBLUE <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span>\nRED <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The imports and variables are fine for those who used Pygame before; the interesting bit is <code class=\"language-text\">os.environ['SDL_VIDEO_CENTERED'] = '1'</code>. SDL, the library which Pygame started off being a wrapper for, uses environment variables for window positioning <a href=\"https://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlenvvars.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><a href=\"https://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlenvvars.html\">https://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlenvvars.html</a></a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pygame<span class=\"token punctuation\">.</span>init<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nboard_font <span class=\"token operator\">=</span> pygame<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>SysFont<span class=\"token punctuation\">(</span><span class=\"token string\">'arial'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">)</span>\ngame_over_font <span class=\"token operator\">=</span> pygame<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>SysFont<span class=\"token punctuation\">(</span><span class=\"token string\">'monospace'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> bold<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nreplay_font <span class=\"token operator\">=</span> pygame<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>SysFont<span class=\"token punctuation\">(</span><span class=\"token string\">'monospace'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\nscreen <span class=\"token operator\">=</span> pygame<span class=\"token punctuation\">.</span>display<span class=\"token punctuation\">.</span>set_mode<span class=\"token punctuation\">(</span>SCREEN_SIZE<span class=\"token punctuation\">)</span>\npygame<span class=\"token punctuation\">.</span>display<span class=\"token punctuation\">.</span>set_caption<span class=\"token punctuation\">(</span><span class=\"token string\">'Tic Tac Toe'</span><span class=\"token punctuation\">)</span>\nclock <span class=\"token operator\">=</span> pygame<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">.</span>Clock<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Call <code class=\"language-text\">pygame.init()</code> as it’s always required and then do other basic setup: add the fonts we’ll be using (one for the Xs and Os and two for the game over screen); setup the screen size and window title; and create the Clock object to keep track of time and manage the framerate.</p>\n<h2>Drawing The Board</h2>\n<p>Before my mind settled into one of the many ways we can represent a game of Tic Tac Toe, I decided to get a visual result to kick it off. What’s Tic Tac Toe without 9 cells? Let’s draw that first:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">draw_lines</span><span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> screen_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Draw vertical lines</span>\n    <span class=\"token comment\"># Lines go from top of screen to bottom of screen</span>\n    vertical_line_1 <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>screen_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># lines mark 1/3 of the board</span>\n    pygame<span class=\"token punctuation\">.</span>draw<span class=\"token punctuation\">.</span>line<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> BLACK<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>vertical_line_1<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>vertical_line_1<span class=\"token punctuation\">,</span> screen_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n    vertical_line_2 <span class=\"token operator\">=</span> vertical_line_1 <span class=\"token operator\">*</span> <span class=\"token number\">2</span>\n    pygame<span class=\"token punctuation\">.</span>draw<span class=\"token punctuation\">.</span>line<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> BLACK<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>vertical_line_2<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>vertical_line_2<span class=\"token punctuation\">,</span> screen_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># Draw horizontal lines</span>\n    horizontal_line_1 <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>screen_size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n    pygame<span class=\"token punctuation\">.</span>draw<span class=\"token punctuation\">.</span>line<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> BLACK<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> horizontal_line_1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>screen_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> horizontal_line_1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n    horizontal_line_2 <span class=\"token operator\">=</span> horizontal_line_1 <span class=\"token operator\">*</span> <span class=\"token number\">2</span>\n    pygame<span class=\"token punctuation\">.</span>draw<span class=\"token punctuation\">.</span>line<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> BLACK<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> horizontal_line_2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>screen_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> horizontal_line_2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>To see the fruits of your (admittedly light) labour we can create the render function and setup the main loop:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> screen_size<span class=\"token punctuation\">,</span> clock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    screen<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span>WHITE<span class=\"token punctuation\">)</span>\n    draw_lines<span class=\"token punctuation\">(</span>screen_size<span class=\"token punctuation\">)</span>\n\n    pygame<span class=\"token punctuation\">.</span>display<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    clock<span class=\"token punctuation\">.</span>tick<span class=\"token punctuation\">(</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> event <span class=\"token keyword\">in</span> pygame<span class=\"token punctuation\">.</span>event<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> event<span class=\"token punctuation\">.</span><span class=\"token builtin\">type</span> <span class=\"token operator\">==</span> pygame<span class=\"token punctuation\">.</span>QUIT<span class=\"token punctuation\">:</span>\n                pygame<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                sys<span class=\"token punctuation\">.</span>exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        render<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> SCREEN_SIZE<span class=\"token punctuation\">,</span> clock<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>In case you don’t know, yes you do have to poll for events even though we’re not processing any input as yet. Pygame must make a call to the event queue for each frame displayed. If you’re writing code that doesn’t need to accept events, you may want to consider the <code class=\"language-text\">pump</code> function. Check the <a href=\"https://www.pygame.org/docs/ref/event.html#pygame.event.pump\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">documentation</a> which talks more about polling events.</p>\n<h2>Drawing Letters</h2>\n<p>Pygame make heavy use of rectangles, the Rect class is absolutely amazing and there’s honestly no reason to be representing positions with tuples aside from utter simplicity - you lose out on so many spectacular methods and attributes! We got our screen to show 9 cells, so it seems natural in Pygame to have 9 rects. With that in mind, we’ll be drawing our Xs and Os to the centre of a rectangle:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">draw_letter</span><span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> letter<span class=\"token punctuation\">,</span> colour<span class=\"token punctuation\">,</span> position_rect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    player_choice <span class=\"token operator\">=</span> board_font<span class=\"token punctuation\">.</span>render<span class=\"token punctuation\">(</span>letter<span class=\"token punctuation\">,</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> colour<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># Fonts are draw to the top left of a Pygame rectangle</span>\n    <span class=\"token comment\"># This game would look better if they're drawn to the centre</span>\n    <span class=\"token comment\"># So after we generate a font image, create a special rectangle</span>\n    <span class=\"token comment\"># that's the center of the cell's rectangle. So the image will</span>\n    <span class=\"token comment\"># appear in the centre</span>\n    choice_rect <span class=\"token operator\">=</span> player_choice<span class=\"token punctuation\">.</span>get_rect<span class=\"token punctuation\">(</span>center<span class=\"token operator\">=</span>position_rect<span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># Blit is Pygame's way of drawing an image to a rectangle</span>\n    screen<span class=\"token punctuation\">.</span>blit<span class=\"token punctuation\">(</span>player_choice<span class=\"token punctuation\">,</span> choice_rect<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Board Mechanics</h2>\n<p>So far we know we’ll have 9 Pygame rectangles, we’ll store them in a lists of lists, similar to a matrix. A 3x3 double list would allow us to easily check for winners later on. Along with the rectangle, each cell should say whether a player already used it (don’t want a player stealing another one’s cell) and whether it has an X or O if played. Let’s setup the board.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">initialise_board</span><span class=\"token punctuation\">(</span>screen_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    board <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    counter <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n    <span class=\"token comment\"># First add 3 lists</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        board<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Then we calculate the width and height of each cell</span>\n    <span class=\"token comment\"># We want each cell to have an even amount of space</span>\n    rect_width <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>screen_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n    rect_height <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>screen_size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># Now we have a list of lists, each list item will have a place to play</span>\n    <span class=\"token comment\"># Outer list with contains each row</span>\n    top <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        left <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n        <span class=\"token comment\"># Inner list which has 3 cells per row</span>\n        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            board<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n                <span class=\"token string\">'played'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'player'</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>counter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># Could be X or O, shows numbers by default</span>\n                <span class=\"token string\">'rect'</span><span class=\"token punctuation\">:</span> pygame<span class=\"token punctuation\">.</span>Rect<span class=\"token punctuation\">(</span>left<span class=\"token punctuation\">,</span> top<span class=\"token punctuation\">,</span> rect_width<span class=\"token punctuation\">,</span> rect_height<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            <span class=\"token comment\"># Add more to the left values so cells don't overlap</span>\n            left <span class=\"token operator\">+=</span> rect_width\n            <span class=\"token comment\"># Increment counter so that it goes up to 9</span>\n            counter <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        <span class=\"token comment\"># Ensure that the top values are increased for every row</span>\n        top <span class=\"token operator\">+=</span> rect_height\n    <span class=\"token keyword\">return</span> board</code></pre></div>\n<p>We show the numbers first to give the users a visual clue of what to press to play. A blank board to someone who doesn’t know the setup would not be particularly helpful.</p>\n<h2>Actually Playing</h2>\n<p>With our visual cues setup, we need to game to accept user input. Before we jump into mapping key presses to board positions, let’s see all the mechanics and think about the game loop. Within the loop we accept user input, update the state and render the new state on the screen. For Tic Tac Toe, we’ll first setup the board and other flags and then go into a loop: the user presses a number on the keyboard; if the users wins or game ends in stalemate stop the game and let them know; otherwise switch the player’s turn and repeat.</p>\n<p>Let’s start with how the game is updated. From the requirements the first player is always X. After X plays we need to change the player to O and vice versa until the game ends. The game loop is always running, we need to ensure that the player change only occurs after someone made a move.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># This function sets up the game's start. It consists of the board, the</span>\n    <span class=\"token comment\"># current turn's player and a flag to change the player's turn.</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">initialise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">'board'</span><span class=\"token punctuation\">:</span> initialise_board<span class=\"token punctuation\">(</span>SCREEN_SIZE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'player'</span><span class=\"token punctuation\">:</span>  <span class=\"token string\">'X'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># The first player will always be X</span>\n                <span class=\"token string\">'change_player'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span> <span class=\"token comment\"># States whether the player attribute has to change</span>\n                <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\"># Create a game object to store state</span>\n    game <span class=\"token operator\">=</span> initialise<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> event <span class=\"token keyword\">in</span> pygame<span class=\"token punctuation\">.</span>event<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> event<span class=\"token punctuation\">.</span><span class=\"token builtin\">type</span> <span class=\"token operator\">==</span> pygame<span class=\"token punctuation\">.</span>QUIT<span class=\"token punctuation\">:</span>\n                pygame<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                sys<span class=\"token punctuation\">.</span>exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># First we collect all the keys pressed in this update</span>\n        keys_pressed <span class=\"token operator\">=</span> pygame<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">.</span>get_pressed<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># If someone acted, update the game state to switch players</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'change_player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> update<span class=\"token punctuation\">(</span>game<span class=\"token punctuation\">,</span> keys_pressed<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># Render screen will need board information, so add game to its parameters</span>\n        render<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> SCREEN_SIZE<span class=\"token punctuation\">,</span> game<span class=\"token punctuation\">,</span> clock<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># After the game is render, switch the current player if someone played</span>\n        <span class=\"token keyword\">if</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'change_player'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'X'</span><span class=\"token punctuation\">:</span>\n                game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'O'</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'X'</span></code></pre></div>\n<p>Now let’s define the update function:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>game<span class=\"token punctuation\">,</span> keys_pressed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    someone_played <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_1<span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_KP1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span>\n        someone_played <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token keyword\">elif</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_2<span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_KP2<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span>\n        someone_played <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token keyword\">elif</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_3<span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_KP3<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span>\n        someone_played <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token keyword\">elif</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_4<span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_KP4<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span>\n        someone_played <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token keyword\">elif</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_5<span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_KP5<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span>\n        someone_played <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token keyword\">elif</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_6<span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_KP6<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span>\n        someone_played <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token keyword\">elif</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_7<span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_KP7<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span>\n        someone_played <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token keyword\">elif</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_8<span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_KP8<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span>\n        someone_played <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token keyword\">elif</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_9<span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_KP9<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span>\n        someone_played <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token keyword\">return</span> someone_played</code></pre></div>\n<p>It’s straightforward. If someone pressed a number, including those on the numpad (the keys with KP before the number), then save the player on that location and set the someone_played flag to True. Returning someone_played will allow us to switch players after someone plays.</p>\n<p>The render function is now updated to show what’s on the board: X, O or the keyboard number we set at the beginning. We’ll draw X in blue and O in green. The numbers will be black.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> screen_size<span class=\"token punctuation\">,</span> game<span class=\"token punctuation\">,</span> clock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    screen<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span>WHITE<span class=\"token punctuation\">)</span>\n    draw_lines<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> screen_size<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Draw the letters if they're played</span>\n    <span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> cell <span class=\"token keyword\">in</span> row<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> cell<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'X'</span><span class=\"token punctuation\">:</span>\n                draw_letter<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> <span class=\"token string\">'X'</span><span class=\"token punctuation\">,</span> BLUE<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">[</span><span class=\"token string\">'rect'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">elif</span> cell<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'O'</span><span class=\"token punctuation\">:</span>\n                draw_letter<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> <span class=\"token string\">'O'</span><span class=\"token punctuation\">,</span> GREEN<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">[</span><span class=\"token string\">'rect'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                draw_letter<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> BLACK<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">[</span><span class=\"token string\">'rect'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n    pygame<span class=\"token punctuation\">.</span>display<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    clock<span class=\"token punctuation\">.</span>tick<span class=\"token punctuation\">(</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Getting The Winner</h2>\n<p>Now that we’re able to play and switch players, we should look at determining the winner or the other end result - a stalemate. Let’s start with the win function. It’s simple enough, a player wins if she has 3 in a row, 3 in a column or 3 diagonally. All you got to remember is that the board is a list of lists, first index is the row and the second index is the column of that row.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">winner</span><span class=\"token punctuation\">(</span>board<span class=\"token punctuation\">,</span> player<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Check win by row</span>\n    <span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> board<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> player <span class=\"token keyword\">and</span> row<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> player <span class=\"token keyword\">and</span>\n                row<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> player<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token comment\"># Check win by column</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>board<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> player <span class=\"token keyword\">and</span> board<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> player <span class=\"token keyword\">and</span>\n                board<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> player<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token comment\"># Check diagonals</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>board<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> player <span class=\"token keyword\">and</span> board<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> player <span class=\"token keyword\">and</span>\n        board<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> player<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>board<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> player <span class=\"token keyword\">and</span> board<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> player <span class=\"token keyword\">and</span>\n        board<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> player<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></code></pre></div>\n<p>We also have to cater for the case that the game reaches the end and neither player wins. Given that we have a played variable, this just means we need to check whether every board position has played set to True.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">is_stalemate</span><span class=\"token punctuation\">(</span>board<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token builtin\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>r<span class=\"token punctuation\">[</span><span class=\"token string\">'played'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> r <span class=\"token keyword\">in</span> row<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> board<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Let’s include them to the main function now:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">initialise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">'board'</span><span class=\"token punctuation\">:</span> initialise_board<span class=\"token punctuation\">(</span>SCREEN_SIZE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'player'</span><span class=\"token punctuation\">:</span>  <span class=\"token string\">'X'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'win'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'stalemate'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'change_player'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span>\n                <span class=\"token punctuation\">}</span>\n\n    game <span class=\"token operator\">=</span> initialise<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> event <span class=\"token keyword\">in</span> pygame<span class=\"token punctuation\">.</span>event<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> event<span class=\"token punctuation\">.</span><span class=\"token builtin\">type</span> <span class=\"token operator\">==</span> pygame<span class=\"token punctuation\">.</span>QUIT<span class=\"token punctuation\">:</span>\n                pygame<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                sys<span class=\"token punctuation\">.</span>exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        keys_pressed <span class=\"token operator\">=</span> pygame<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">.</span>get_pressed<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'change_player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> update<span class=\"token punctuation\">(</span>game<span class=\"token punctuation\">,</span> keys_pressed<span class=\"token punctuation\">)</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'win'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> winner<span class=\"token punctuation\">(</span>game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'stalemate'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> is_stalemate<span class=\"token punctuation\">(</span>game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n        render<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> SCREEN_SIZE<span class=\"token punctuation\">,</span> game<span class=\"token punctuation\">,</span> clock<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">if</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'change_player'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> <span class=\"token punctuation\">(</span>game<span class=\"token punctuation\">[</span><span class=\"token string\">'win'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'stalemate'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'X'</span><span class=\"token punctuation\">:</span>\n                game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'O'</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'X'</span></code></pre></div>\n<p>We’ve made a few additions to main update. Firstly, the initial state now includes two flags for winning or stalemate. After the game is updated we check to see if a player won, and then check if it’s a stalemate. Note that with our current logic, a game can be won and stalemate at the same time. At this point we want to use these variables to show the user who won, and all allow them to restart the match by hitting spacebar.</p>\n<h3>Wrapping It Up</h3>\n<p>Let’s allow the game to be played over and over again, we’ll do this by rendering two messages: the first stating who won if someone did, the second informing the user to press spacebar to restart. After that we’ll modify the main function so that if the game is ended, the user can press spacebar to restart it.</p>\n<p>As the messages are essentially the same and just need their content changed, let’s create a function to display both messages. We created two fonts earlier, so we’ll ensure the function handles both as well.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">end_game_message</span><span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> screen_size<span class=\"token punctuation\">,</span> main_message<span class=\"token punctuation\">,</span> main_font<span class=\"token punctuation\">,</span>\n        replay_message<span class=\"token punctuation\">,</span> replay_font<span class=\"token punctuation\">,</span> colour<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    main_text <span class=\"token operator\">=</span> main_font<span class=\"token punctuation\">.</span>render<span class=\"token punctuation\">(</span>main_message<span class=\"token punctuation\">,</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> colour<span class=\"token punctuation\">)</span>\n    main_rect <span class=\"token operator\">=</span> main_text<span class=\"token punctuation\">.</span>get_rect<span class=\"token punctuation\">(</span>center<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>screen_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> screen_size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    screen<span class=\"token punctuation\">.</span>blit<span class=\"token punctuation\">(</span>main_text<span class=\"token punctuation\">,</span> main_rect<span class=\"token punctuation\">)</span>\n    replay_text <span class=\"token operator\">=</span> replay_font<span class=\"token punctuation\">.</span>render<span class=\"token punctuation\">(</span>replay_message<span class=\"token punctuation\">,</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> colour<span class=\"token punctuation\">)</span>\n    replay_rect <span class=\"token operator\">=</span> replay_text<span class=\"token punctuation\">.</span>get_rect<span class=\"token punctuation\">(</span>center<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>screen_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n        main_rect<span class=\"token punctuation\">.</span>bottom <span class=\"token operator\">+</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    screen<span class=\"token punctuation\">.</span>blit<span class=\"token punctuation\">(</span>replay_text<span class=\"token punctuation\">,</span> replay_rect<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Pretty straightforward: setup the font, get it’s rect and place on the screen. When including this in our render function, we need this message to appear in front of the other objects on the screen (so we render it last) and we need to ensure it only appears when the game has ended.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> screen_size<span class=\"token punctuation\">,</span> game<span class=\"token punctuation\">,</span> clock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    screen<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span>WHITE<span class=\"token punctuation\">)</span>\n    draw_lines<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> screen_size<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Draw the letters if they're played</span>\n    <span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> cell <span class=\"token keyword\">in</span> row<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> cell<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'X'</span><span class=\"token punctuation\">:</span>\n                draw_letter<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> <span class=\"token string\">'X'</span><span class=\"token punctuation\">,</span> BLUE<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">[</span><span class=\"token string\">'rect'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">elif</span> cell<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'O'</span><span class=\"token punctuation\">:</span>\n                draw_letter<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> <span class=\"token string\">'O'</span><span class=\"token punctuation\">,</span> GREEN<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">[</span><span class=\"token string\">'rect'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                draw_letter<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> BLACK<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">[</span><span class=\"token string\">'rect'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'win'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n        win_message <span class=\"token operator\">=</span> <span class=\"token string\">'Player '</span> <span class=\"token operator\">+</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">' won!'</span>\n        end_game_message<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> SCREEN_SIZE<span class=\"token punctuation\">,</span> win_message<span class=\"token punctuation\">,</span> game_over_font<span class=\"token punctuation\">,</span>\n                REPLAY_MESSAGE<span class=\"token punctuation\">,</span> replay_font<span class=\"token punctuation\">,</span> RED<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">elif</span> <span class=\"token keyword\">not</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'win'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">and</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'stalemate'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n        stale_message <span class=\"token operator\">=</span> <span class=\"token string\">'Stalemate!'</span>\n        end_game_message<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> SCREEN_SIZE<span class=\"token punctuation\">,</span> stale_message<span class=\"token punctuation\">,</span> game_over_font<span class=\"token punctuation\">,</span>\n                REPLAY_MESSAGE<span class=\"token punctuation\">,</span> replay_font<span class=\"token punctuation\">,</span> RED<span class=\"token punctuation\">)</span>\n\n    pygame<span class=\"token punctuation\">.</span>display<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    clock<span class=\"token punctuation\">.</span>tick<span class=\"token punctuation\">(</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Recall that with our previous logic that if someone wins on the last move, then the game’s win and stalemate flags would both be True. To ensure we display the right message, we always show the winning message once someone wins and we only show the stalemate message if it’s also true that no one won. If you play a game you’ll see the message pop up! Now all we need to do is modify it so that spacebar resets the game.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">initialise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">'board'</span><span class=\"token punctuation\">:</span> initialise_board<span class=\"token punctuation\">(</span>SCREEN_SIZE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'player'</span><span class=\"token punctuation\">:</span>  <span class=\"token string\">'X'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'win'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'stalemate'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'change_player'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span>\n                <span class=\"token punctuation\">}</span>\n\n    game <span class=\"token operator\">=</span> initialise<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> event <span class=\"token keyword\">in</span> pygame<span class=\"token punctuation\">.</span>event<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> event<span class=\"token punctuation\">.</span><span class=\"token builtin\">type</span> <span class=\"token operator\">==</span> pygame<span class=\"token punctuation\">.</span>QUIT<span class=\"token punctuation\">:</span>\n                pygame<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                sys<span class=\"token punctuation\">.</span>exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        keys_pressed <span class=\"token operator\">=</span> pygame<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">.</span>get_pressed<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># The game only updates if no one won and there's space to play</span>\n        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> <span class=\"token punctuation\">(</span>game<span class=\"token punctuation\">[</span><span class=\"token string\">'win'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'stalemate'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            game<span class=\"token punctuation\">[</span><span class=\"token string\">'change_player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> update<span class=\"token punctuation\">(</span>game<span class=\"token punctuation\">,</span> keys_pressed<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># Only allow a reset if the game is over</span>\n            <span class=\"token keyword\">if</span> keys_pressed<span class=\"token punctuation\">[</span>pygame<span class=\"token punctuation\">.</span>K_SPACE<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n                game <span class=\"token operator\">=</span> initialise<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'win'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> winner<span class=\"token punctuation\">(</span>game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        game<span class=\"token punctuation\">[</span><span class=\"token string\">'stalemate'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> is_stalemate<span class=\"token punctuation\">(</span>game<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n        render<span class=\"token punctuation\">(</span>screen<span class=\"token punctuation\">,</span> SCREEN_SIZE<span class=\"token punctuation\">,</span> game<span class=\"token punctuation\">,</span> clock<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># Well if the last move didn't win/end the game, switch to the other player</span>\n        <span class=\"token keyword\">if</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'change_player'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> <span class=\"token punctuation\">(</span>game<span class=\"token punctuation\">[</span><span class=\"token string\">'win'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'stalemate'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'X'</span><span class=\"token punctuation\">:</span>\n                game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'O'</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                game<span class=\"token punctuation\">[</span><span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'X'</span></code></pre></div>\n<p>We only allow the spacebar to reset the game when it’s over and to ensure that the user can’t play while the game is over we add some checks by the update function and the player switch logic. Without resetting the game with spacebar, the game would not update. And that’s our game! If in doubt, you can compare your source code to <a href=\"https://gist.github.com/msanatan/fc7eb982e3f7f5842f19c8e6d5a3759d\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">mine</a>. There are slight differences in the order but this is everything.</p>\n<h2>One More Thing</h2>\n<p>I’m sure the vast majority of your friends won’t be going on the command line to run Python files and play your game. Let’s package it in a format they can easily use. <a href=\"https://anthony-tuininga.github.io/cx_Freeze/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">cx_Freeze</a> takes your Python scripts and makes them into executables. It’s perfect for what we want. Install with pip <code class=\"language-text\">pip install cx_Freeze</code> and create a <em>setup.py</em> file in your directory with the following content:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> cx_Freeze\n\nexecutables <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>cx_Freeze<span class=\"token punctuation\">.</span>Executable<span class=\"token punctuation\">(</span><span class=\"token string\">'tictactoe.py'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\ncx_Freeze<span class=\"token punctuation\">.</span>setup<span class=\"token punctuation\">(</span>\n        name<span class=\"token operator\">=</span><span class=\"token string\">'Tic Tac Toe'</span><span class=\"token punctuation\">,</span>\n        version<span class=\"token operator\">=</span><span class=\"token string\">'1.0.0'</span><span class=\"token punctuation\">,</span>\n        description<span class=\"token operator\">=</span><span class=\"token string\">'Tic Tac Toe for the masses'</span><span class=\"token punctuation\">,</span>\n        options<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'build_exe'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">'packages'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'pygame'</span><span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        executables<span class=\"token operator\">=</span>executables\n        <span class=\"token punctuation\">)</span></code></pre></div>\n<p>There isn’t much to this script, just telling cx_Freeze where’s the file, some metadata and the library needed for the file to work. I’m using macOS, to get my installer I run <code class=\"language-text\">python setup.py bdist_dmg</code>. For Windows OSes your last arugment will be bdist_msi. If you just want an executable without an installer, simply use ‘build’ as the last argument. Definitely read the docs and play with it!</p>\n<h2>Next Steps</h2>\n<p>Well done on making it through this tutorial, you got a fully functional game on your hands! There are some ways we can improve it, try your hand at the following:</p>\n<ol>\n<li>Allow for plays to be made with mouse clicks</li>\n<li>Add a victory sound if someone wins</li>\n<li>Make the game fullscreen</li>\n<li>If using cx_Freeze, the build size is quite large. Looks for ways to reduce it (hint: check out the ‘excludes’ argument)</li>\n</ol>\n<p>Hope you enjoyed, happy hacking!</p>","frontmatter":{"title":"Fun with Pygame","tags":["python","pygame","game development"],"date":"2017-10-05","updated":null}},"previous":{"fields":{"slug":"/blog/2017/06/18/react-native-lessons-from-first-app"},"frontmatter":{"title":"React Native: Lessons from First App"}},"next":{"fields":{"slug":"/blog/2017/10/31/things-to-do-after-setting-up-hexo"},"frontmatter":{"title":"Things to Do After Setting up Hexo"}}},"pageContext":{"id":"41d7556c-8e0a-56ce-80fc-20f4faeba704","previousPostId":"6d642388-b856-5732-8c9a-c0c21d245d50","nextPostId":"3deedfd7-14f4-574e-8a74-f02d67c09827"}},"staticQueryHashes":["1391858338"],"slicesMap":{}}