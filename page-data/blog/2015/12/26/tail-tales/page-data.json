{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2015/12/26/tail-tales/","result":{"data":{"site":{"siteMetadata":{"title":"Marcus Sanatan"}},"markdownRemark":{"id":"7f2f8b6a-2067-5272-9266-36fb211d8d31","excerpt":"Not too long ago I found myself in a little jam using the tail command. I needed to keep tabs on a log file which would be archived and emptied when it reaches…","html":"<p>Not too long ago I found myself in a little jam using the tail command. I needed to keep tabs on a log file which would be archived and emptied when it reaches a certain size. Since the script I was writing would need all the contents that was logged and not only what was currently in the file, I had this running in the background:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">tail</span> <span class=\"token parameter variable\">-f</span> sexy_log_file.txt <span class=\"token operator\">>></span> all_logged_stuff.txt</code></pre></div>\n<p>I thought that was straightforward enough. So after a few minutes I wanted to see if my little command works (by then the log file would have archived its old content and start over). To my not so pleasant surprise it just stopped tailing. Well that sucked. This time I was decided to watch it attentively and noticed that it stopped following the file when the old content is archived and it got emptied.</p>\n<h2>Why Tail No Follow?</h2>\n<p>Even with the same name, the properties of the file will change. Unix file systems store the contents of the file and the metadata about the file in two separate data structures. The metadata is called an inode. They store lots of stuff about a file: it’s location, the owner, permissions, timestamps and more. Each file has a unique inode number. You can get the inode number of a file with <code class=\"language-text\">ls -i &lt;file></code>. The -f option of tells tail to follow a file by its descriptor. So as the file is overwritten, the inode number changes and thus tail stops following. You can easily test it: create a file, check the inode number, use a text editor and add something, save changes and recheck the inode number and you’ll see it’s different.</p>\n<h2>The Solution</h2>\n<p>To circumvent this issue, you simply need to make the following change</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">tail</span> <span class=\"token parameter variable\">-F</span> sexy_log_file.txt</code></pre></div>\n<p>The capital F tells tail to follow the file by its name, not its properties. If you delete a file while using <code class=\"language-text\">tail -F</code> a messages comes up saying that it’s gone, and when you recreate it with the same name another message comes up saying that it’s back to following its contents. Now that my tail-induced headache is gone, I can get back to scripting in peace :). Happy hacking everyone!</p>","frontmatter":{"title":"Tail Tales","tags":["bash"],"date":"2015-12-26","updated":null}},"previous":{"fields":{"slug":"/blog/2015/11/07/to-app-or-not-to-app-that-is-not-the-question"},"frontmatter":{"title":"To App, or not to App? That is not the Question"}},"next":{"fields":{"slug":"/blog/2016/03/17/death-to-the-buzzword-long-live-development"},"frontmatter":{"title":"Death to the Buzzword, Long Live Development"}}},"pageContext":{"id":"7f2f8b6a-2067-5272-9266-36fb211d8d31","previousPostId":"13c92527-3e2b-5d79-ae49-e6280db86f81","nextPostId":"81bbe2d7-ba37-5e9c-b8a3-2cdc998288e4"}},"staticQueryHashes":["1391858338"],"slicesMap":{}}